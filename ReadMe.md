# Mineral 

Mineral，是一個作者針對自己工作環境撰寫的備份工具。<br>
主要用於備份及追蹤"非原始碼檔案"的變化。<br>


## 緣起

會撰寫這程式的原因，主要是因為工作上還是經常有操作文件(Libre Office Writer / Word)<br>、試算表(LibreOffice Calc / Microsoft Excel)等的需求。
其中，LibreOffice Writer跟 Microsoft Word<br>

 雖然有提供追蹤校訂功能，但這兩者如果在檔案完全損壞的狀況下是無法發揮功用的。
 在這段時間裡面，可能由於系統穩定性上的問題(有一陣子不小心都下載到LibreOffice的Pre-release)、同時跑過多軟體(多個IDE同時偵錯+多份文件、試算表檢視)。
 經常導致系統Crash。這種狀況下，軟體多少能夠就一些回來，但在這樣的環境下第一次經歷了甚麼叫做檔案徹底壞掉。<br>

 檔案壞掉的經歷，發生在LibreOffice Writer，某次Pre-Release版本掛掉之後，
 檔案就顯示無法讀取。好奇之下打開來看才發現，檔案的內容竟然變成Apahce License。
 基本已經無法修復，當下只能幾天前複製的備份版本複製，損失那幾天的工作量。<br>

 Excel方面則是另一個故事，因為我工作上會使用Excel來跟客戶對工作進度。
 所以這方面的操作可以說是相當頻繁。但也因為進度常常因為突發事件改變，導致需要頻繁的增刪改。而Excel在單人的環境下是沒有追蹤校訂功能，或者說Excel根本不是為了這種目的設計的。如果要保護這些成果，能做的基本也只有把整個檔案複製到他處保存。<br>

 試過使用版控軟體(這邊基於好奇是用Mercurial),但是對於Office檔案這種內容泰半都由軟體操作的檔案而言，即使有明碼版(fodt)也沒有甚麼差異，更不用說一般壓縮過的二進位檔案對版控而言根本毫無意義。期間還經歷了不小心下錯指令把repository玩壞的經驗。

 加上一般版控軟體的repository區塊(.git / .hg 資料夾)，也沒有預設要讓人類讀取，如果損壞又不會修的話甚至更慘。<br>

 仔細想想，我需要的也就只是把我自己已經做了幾千次的手動備份動作自動化而已。<br>
 所以就來寫了，故事就是這樣。 <br>
 同時，因為這種備份就像是地質活動一樣，會不斷的累積，檔案就像地層中的礦物質，<br>
 會逐漸結晶乃至行程礦脈、地層、礦產，因此這個程式以礦物質為名，其他指令也以地質學名詞作為靈感來源。

## 相關規格

||||
|--:|---|--|
|Ruby版本|3.1.1p18|注意：無處理向下相容問題。|
|Mineral版本|0.2.0|Beta版，已完成基礎測試，正在進行實際驗證動作。|

## 版本命名方式
- 目前第一碼為0，因為初版規格尚未完全制定，內部測試完後，會更新為1.0.0。
- 採三位數命名方式。第一位表示對外API規格(有功能增減時，更新此位)，第二位表示規格增修(如單一功能增加選項、影響較大之除錯等等)，第三位表示細節修正，如修改錯字、排版改變(空白換Tab、修正拼字錯誤、改變用語、true/false條件判斷寫反...等)。

## 參數

這個軟體定義了以下幾個共用參數，

|參數名稱|用途|預設值|備註|
|--|--|--|--|
|-base|要備份的資料所在資料夾|無，必填項目||
|-tgt|備份目標位置|-base的所在資料夾 / Mine / {base資料夾名稱} ||
|-vein|差異資料(如果有)擺放位置|-base的所在資料夾 / Mine / vein|vein=礦脈|
|-veinless|不記錄差異資料|false|未實作|

## 使用方式

目前這個軟體主要有兩個功能：

1. form：形成地質，複製並比對兩邊差異。
    
    使用 Form.cmd 或是以下參數列指令：

        ruby Mineral.Main.rb form -base {資料夾名稱}

2. sediment: 沉積，自動將檔案複製到依照日期命名的備份資料夾中。

    使用 Sediment.cmd 或是以下參數列指令：
    
        ruby Mineral.Main.rb sediment -base {資料夾名稱}